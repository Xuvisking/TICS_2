{"ast":null,"code":"import _regeneratorRuntime from \"D:/Archivos de programa/Universidad/Ramos/2020-2/Proyecto en Tics 2/Proyecto/codigo-tics2/TICS_2/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"D:/Archivos de programa/Universidad/Ramos/2020-2/Proyecto en Tics 2/Proyecto/codigo-tics2/TICS_2/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport swal from \"sweetalert\";\nimport { fetchSinToken, fetchConToken } from \"../helpers/fetch\";\nimport { types } from '../types/types';\nexport var startLogin = function startLogin(id, password) {\n  return /*#__PURE__*/function () {\n    var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(dispatch) {\n      var resp, body;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.next = 2;\n              return fetchSinToken('api/auth', {\n                id: id,\n                password: password\n              }, 'POST');\n\n            case 2:\n              resp = _context.sent;\n              _context.next = 5;\n              return resp.json();\n\n            case 5:\n              body = _context.sent;\n\n              if (body.ok) {\n                console.log('ok');\n                localStorage.setItem('token', body.token);\n                localStorage.setItem('token-comienzo', new Date().getTime());\n                dispatch(login({\n                  id: body.id\n                }));\n              } else {\n                swal(\"Error\", body.msg, \"error\");\n              }\n\n            case 7:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n\n    return function (_x) {\n      return _ref.apply(this, arguments);\n    };\n  }();\n};\n\nvar login = function login(id) {\n  return {\n    type: types.authLogin,\n    payload: id\n  };\n};\n\nexport var startLogout = function startLogout() {\n  return function (dispatch) {\n    localStorage.clear();\n    dispatch(logout());\n  };\n};\n\nvar logout = function logout() {\n  return {\n    type: types.authLogout\n  };\n};","map":{"version":3,"sources":["D:/Archivos de programa/Universidad/Ramos/2020-2/Proyecto en Tics 2/Proyecto/codigo-tics2/TICS_2/frontend/src/actions/auth.js"],"names":["swal","fetchSinToken","fetchConToken","types","startLogin","id","password","dispatch","resp","json","body","ok","console","log","localStorage","setItem","token","Date","getTime","login","msg","type","authLogin","payload","startLogout","clear","logout","authLogout"],"mappings":";;AAAA,OAAOA,IAAP,MAAiB,YAAjB;AACA,SAASC,aAAT,EAAwBC,aAAxB,QAA6C,kBAA7C;AACA,SAASC,KAAT,QAAsB,gBAAtB;AAEA,OAAO,IAAMC,UAAU,GAAG,SAAbA,UAAa,CAACC,EAAD,EAAKC,QAAL,EAAkB;AACxC;AAAA,wEAAO,iBAAOC,QAAP;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,qBACgBN,aAAa,CAAC,UAAD,EAAa;AAAEI,gBAAAA,EAAE,EAAFA,EAAF;AAAMC,gBAAAA,QAAQ,EAARA;AAAN,eAAb,EAA+B,MAA/B,CAD7B;;AAAA;AACGE,cAAAA,IADH;AAAA;AAAA,qBAEgBA,IAAI,CAACC,IAAL,EAFhB;;AAAA;AAEGC,cAAAA,IAFH;;AAGH,kBAAIA,IAAI,CAACC,EAAT,EAAa;AACTC,gBAAAA,OAAO,CAACC,GAAR,CAAY,IAAZ;AACAC,gBAAAA,YAAY,CAACC,OAAb,CAAqB,OAArB,EAA8BL,IAAI,CAACM,KAAnC;AACAF,gBAAAA,YAAY,CAACC,OAAb,CAAqB,gBAArB,EAAuC,IAAIE,IAAJ,GAAWC,OAAX,EAAvC;AACAX,gBAAAA,QAAQ,CAACY,KAAK,CAAC;AACXd,kBAAAA,EAAE,EAAEK,IAAI,CAACL;AADE,iBAAD,CAAN,CAAR;AAGH,eAPD,MAQK;AACDL,gBAAAA,IAAI,CAAC,OAAD,EAAUU,IAAI,CAACU,GAAf,EAAoB,OAApB,CAAJ;AACH;;AAbE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAP;;AAAA;AAAA;AAAA;AAAA;AAeH,CAhBM;;AAkBP,IAAMD,KAAK,GAAG,SAARA,KAAQ,CAACd,EAAD;AAAA,SAAS;AACnBgB,IAAAA,IAAI,EAAElB,KAAK,CAACmB,SADO;AAEnBC,IAAAA,OAAO,EAAElB;AAFU,GAAT;AAAA,CAAd;;AAKA,OAAO,IAAMmB,WAAW,GAAG,SAAdA,WAAc,GAAM;AAC7B,SAAO,UAACjB,QAAD,EAAc;AACjBO,IAAAA,YAAY,CAACW,KAAb;AACAlB,IAAAA,QAAQ,CAACmB,MAAM,EAAP,CAAR;AACH,GAHD;AAIH,CALM;;AAOP,IAAMA,MAAM,GAAG,SAATA,MAAS;AAAA,SAAO;AAACL,IAAAA,IAAI,EAAElB,KAAK,CAACwB;AAAb,GAAP;AAAA,CAAf","sourcesContent":["import swal from \"sweetalert\";\r\nimport { fetchSinToken, fetchConToken } from \"../helpers/fetch\";\r\nimport { types } from '../types/types';\r\n\r\nexport const startLogin = (id, password) => {\r\n    return async (dispatch) => {\r\n        const resp = await fetchSinToken('api/auth', { id, password }, 'POST');\r\n        const body = await resp.json();\r\n        if (body.ok) {\r\n            console.log('ok')\r\n            localStorage.setItem('token', body.token);\r\n            localStorage.setItem('token-comienzo', new Date().getTime());\r\n            dispatch(login({\r\n                id: body.id\r\n            }));\r\n        }\r\n        else {\r\n            swal(\"Error\", body.msg, \"error\");\r\n        }\r\n    };\r\n};\r\n\r\nconst login = (id) => ({\r\n    type: types.authLogin,\r\n    payload: id\r\n});\r\n\r\nexport const startLogout = () => {\r\n    return (dispatch) => {\r\n        localStorage.clear();\r\n        dispatch(logout());\r\n    };\r\n};\r\n\r\nconst logout = () => ({type: types.authLogout});"]},"metadata":{},"sourceType":"module"}